{% extends "base.html" %}

{% block title %}Register - BLOCKMAN GO{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-box">
        <div class="auth-header">
            <div class="auth-logo">BLOCKMAN <span>GO</span></div>
            <div class="auth-title">Create Account</div>
        </div>
        
        <form method="POST" action="{{ url_for('register') }}" id="registerForm">
            <div class="form-group">
                <label class="form-label">Username</label>
                <input type="text" class="form-input" name="username" 
                       placeholder="Choose a username" required
                       oninput="checkUsername(this.value)">
                <small id="username-msg" class="input-hint"></small>
            </div>
            
            <div class="form-group">
                <label class="form-label">Email Address</label>
                <input type="email" class="form-input" name="email" 
                       placeholder="Enter your email" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">Password</label>
                <input type="password" class="form-input" name="password" 
                       placeholder="Create a password" required>
                <small class="input-hint">At least 6 characters</small>
            </div>
            
            <div class="form-group">
                <label class="form-label">Confirm Password</label>
                <input type="password" class="form-input" name="confirm_password" 
                       placeholder="Confirm your password" required>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="auth-btn" id="registerBtn">
                    CREATE ACCOUNT
                </button>
            </div>
        </form>
        
        <div class="auth-links">
            <a href="{{ url_for('login') }}" class="auth-link">
                ← Back to Login
            </a>
        </div>
    </div>
</div>

<script>
function checkUsername(username) {
    if (username.length < 3) {
        document.getElementById('username-msg').innerHTML = 'Minimum 3 characters';
        document.getElementById('username-msg').style.color = '#ff6b00';
        return;
    }
    
    if (username.length > 20) {
        document.getElementById('username-msg').innerHTML = 'Maximum 20 characters';
        document.getElementById('username-msg').style.color = '#ff6b00';
        return;
    }
    
    // Check username availability
    fetch('/check-username/' + encodeURIComponent(username))
        .then(response => response.json())
        .then(data => {
            const msgElement = document.getElementById('username-msg');
            if (data.available) {
                msgElement.innerHTML = '✓ Username available';
                msgElement.style.color = '#2ed573';
            } else {
                msgElement.innerHTML = '✗ Username already taken';
                msgElement.style.color = '#ff4757';
            }
        });
}

// Form validation
document.getElementById('registerForm').addEventListener('submit', function(e) {
    const password = document.querySelector('input[name="password"]').value;
    const confirmPassword = document.querySelector('input[name="confirm_password"]').value;
    
    if (password.length < 6) {
        e.preventDefault();
        alert('Password must be at least 6 characters');
        return false;
    }
    
    if (password !== confirmPassword) {
        e.preventDefault();
        alert('Passwords do not match');
        return false;
    }
    
    // Show loading
    const btn = document.getElementById('registerBtn');
    btn.innerHTML = 'Creating Account...';
    btn.disabled = true;
});
</script>
{% endblock %}